<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>ซื้อ M-BLITHE ลิปซอฟแมท สีสวย ติดทนนาน ส่งฟรี เก็บเงินปลายทาง</title>
  <meta name="description" content="ลิปซอฟแมท M-BLITHE เม็ดสีแน่น สีสวย ติดทนนาน ไม่แห้งปาก รีวิวจริงจากลูกค้าหลายพันคน ส่งฟรี เก็บเงินปลายทาง เหมาะสำหรับทุกโทนผิว">
  <meta name="keywords" content="ลิปซอฟแมท, ลิปแมท, ลิป M-BLITHE, ลิปสีสวย, ลิปติดทน, ส่งฟรี, เก็บเงินปลายทาง">
  <link rel="canonical" href="https://tuowzz.github.io/mbshopz.github.io/softmattelip" />

  <!-- Facebook Pixel -->
  <script>
    !function(f,b,e,v,n,t,s){
      if(f.fbq)return;n=f.fbq=function(){n.callMethod?
      n.callMethod.apply(n,arguments):n.queue.push(arguments)};
      if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
      n.queue=[];t=b.createElement(e);t.async=!0;
      t.src=v;s=b.getElementsByTagName(e)[0];
      s.parentNode.insertBefore(t,s)}(window, document,'script',
      'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '127978927946856');
    fbq('track', 'PageView');
    fbq('track', 'ViewContent');
  </script>
  <noscript>
    <img height="1" width="1" style="display:none"
      src="https://www.facebook.com/tr?id=127978927946856&ev=PageView&noscript=1"/>
  </noscript>
  <!-- TikTok Pixel -->
  <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject = t;
      var ttq = w[t] = w[t] || [];
      ttq.methods = ["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie"];
      ttq.setAndDefer = function (t, e) { t[e] = function () { t.push([e].concat(Array.prototype.slice.call(arguments, 0))) } };
      for (var i = 0; i < ttq.methods.length; i++) { ttq.setAndDefer(ttq, ttq.methods[i]) }
      ttq.instance = function (t) { for (var e = ttq._i[t] || [], n = 0; n < ttq.methods.length; n++) { ttq.setAndDefer(e, ttq.methods[n]) } return e };
      ttq.load = function (e, n) {
        var i = "https://analytics.tiktok.com/i18n/pixel/events.js";
        ttq._i = ttq._i || {};
        ttq._i[e] = [];
        ttq._i[e]._u = i;
        ttq._t = ttq._t || {};
        ttq._t[e] = +new Date;
        ttq._o = ttq._o || {};
        ttq._o[e] = n || {};
        var o = document.createElement("script");
        o.type = "text/javascript";
        o.async = !0;
        o.src = i + "?sdkid=" + e + "&lib=" + t;
        var a = document.getElementsByTagName("script")[0];
        a.parentNode.insertBefore(o, a)
      };
      ttq.load('D0EVS2JC77U9C23772EG');
      ttq.page();
      ttq.track('ViewContent');
    }(window, document, 'ttq');
  </script>
  <!-- Google Ads Pixel (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17035064059"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'AW-17035064059');
  </script>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <style>
    :root {
      --primary-color: #e94057;
      --lip-pink: #e94057;
      --lip-light: #fff5f7;
      --white: #fff;
      --border-color: #e8e8e8;
      --background: #f8f8fa;
      --shadow: 0 2px 18px 0 rgba(24,16,52,.07);
    }
    body {
      font-family: 'Kanit', sans-serif;
      margin: 0;
      background: var(--background);
      color: #161823;
      padding-bottom: 75px;
      min-height: 100vh;
    }
    .product-gallery img {
      width: 100%; display: block; border-bottom: 1px solid var(--border-color);
    }
    .trust-banner {
      background: var(--lip-light);
      color: var(--lip-pink);
      text-align: center;
      font-weight: 700;
      font-size: 1.04rem;
      padding: 10px 0;
      border-bottom: 1px solid #ffd1d8;
      letter-spacing: .1px;
    }
    .content-padding {
      padding: 15px 17px;
      background: var(--white);
      margin-bottom: 10px;
      border-radius: 0 0 13px 13px;
      box-shadow: 0 2px 13px 0 rgba(233,64,87,0.07);
    }
    .lip-label {
      display: inline-block;
      background: var(--lip-pink);
      color: #fff;
      font-size: 0.92rem;
      font-weight: 700;
      border-radius: 5px;
      padding: 2px 9px;
      margin-right: 6px;
      margin-bottom: 5px;
    }
    .lip-label.green {background:#22c55e;}
    .lip-label.yellow {background:#ffb300;}
    .lip-label.black {background:#222;}
    .product-title {
      font-size: 1.15rem;
      font-weight: 600;
      margin-top: 12px;
      margin-bottom: 3px;
    }
    .price-section {
      display: flex; align-items: center; gap: 13px;
      font-size: 1.20rem; font-weight: 700;
    }
    .price-section .current-price {
      color: var(--lip-pink); font-size: 2rem;font-weight:800;
    }
    .price-section .original-price {
      color: #b0b0b0; text-decoration: line-through; font-size: 1.11rem; font-weight: 400;
      margin-left: 10px;
    }
    .scarcity-box {
      background: #fff0f5;
      border: 1.5px dashed var(--lip-pink);
      border-radius: 9px;
      text-align: center;
      font-size: 1.06rem;
      font-weight: 600;
      margin: 15px 0 0 0;
      color: var(--lip-pink);
      padding: 11px 11px 10px 11px;
      animation: shake .8s infinite alternate;
    }
    @keyframes shake {
      0% { transform: translateY(0);}
      80% { transform: translateY(-1px);}
      100% { transform: translateY(2px);}
    }
    .shop-info {
      display: flex; align-items: center; gap: 13px; margin: 13px 0;
    }
    .shop-info .avatar {
      width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #ff7e5f, #feb47b);
      display: flex; align-items: center; justify-content: center; font-weight: 700;
      color: var(--white); font-size: 1.13rem;
    }
    .shop-info .shop-name { font-weight: 600; }
    .btn-add-line {
      display: flex; align-items: center; justify-content: center; gap: 10px;
      background: #06c755;
      color: #fff !important;
      font-size: 1.04rem;
      font-weight: 700;
      border: none;
      border-radius: 7px;
      padding: 13px 20px;
      margin-top: 6px;
      margin-bottom: 6px;
      cursor: pointer;
      transition: background .18s;
      box-shadow: 0 2px 10px 0 rgba(6,199,85,0.08);
      text-decoration: none;
      width: 100%;
    }
    .btn-add-line:active { background: #04803e;}
    .btn-add-line i { font-size: 1.35rem;}
    .steps-box {
      background: #f6faff; border-radius: 8px; padding: 9px 11px 9px 13px; margin-bottom: 13px;
      font-size: 1.03rem;
    }
    .guarantee-box {
      text-align: center; color: #e94057; font-weight: 600; margin-bottom: 10px;
      background: #fff6f7; padding: 8px 11px; border-radius: 8px;
    }
    .product-details h3, .reviews-section h3 {
      font-size: 1.09rem; font-weight: 600; margin-bottom: 11px;
    }
    .feature-item {
      display: flex; align-items: center; gap: 10px; margin-bottom: 11px; font-size: 0.97rem;
    }
    .feature-item .icon { font-size: 1.2rem; color: #e94057; }
    .review-header { display: flex; align-items: center; gap: 7px; margin-bottom: 6px; }
    .review-header .stars { color: #f9d71c; }
    .review-header .author { font-weight: 500; font-size: 0.93rem; }
    .review-text { font-size: 0.97rem; line-height: 1.46; }
    .sticky-footer {
      position: fixed; bottom: 0; left: 0; right: 0;
      background-color: var(--white);
      border-top: 1px solid var(--border-color);
      display: flex; z-index: 999;
      height: 62px;
      box-shadow: 0 -2px 16px 0 rgba(0,0,0,0.08);
    }
    .sticky-footer .btn-add-line {
      width: 37%; border-radius: 0; font-size: 1.09rem; height: 100%;
      margin: 0; border-right: 1px solid #eee; justify-content: center;
    }
    .sticky-footer .buy-now-tiktok {
      background: var(--lip-pink);
      color: #fff; font-weight: 700; border: none; border-radius: 0;
      font-size: 1.22rem; width: 63%; height: 100%;
      cursor: pointer; transition: background 0.13s;
    }
    .sticky-footer .buy-now-tiktok:active { opacity: 0.92; }
    .modal-overlay {
      position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.53); z-index: 3000;
      display: none; flex-direction: column; justify-content: flex-end;
      animation: fadeInBg 0.2s;
    }
    @keyframes fadeInBg {
      from { background: rgba(0,0,0,0.0);}
      to { background: rgba(0,0,0,0.53);}
    }
    .modal-content {
      background: #fff;
      border-radius: 16px 16px 0 0;
      padding: 22px 16px 18px 16px;
      animation: slideUp .19s cubic-bezier(0.4,1.13,0.41,1.32);
      max-height: 93vh; overflow-y: auto;
      box-shadow: var(--shadow);
      position: relative;
    }
    @keyframes slideUp { from { transform: translateY(30%); opacity:0 } to { transform: translateY(0); opacity:1} }
    .close-btn {
      position: absolute; top: 13px; right: 15px; font-size: 1.5rem; color: #b5b5b5; cursor: pointer; z-index: 10;
    }
    .modal-header {
      display: flex; gap: 16px; align-items: center; border-bottom: 1px solid #f2f2f2; padding-bottom: 10px; margin-bottom: 11px;
    }
    .modal-header img {
      width: 66px; height: 66px; border-radius: 8px; object-fit: cover; border: 1px solid #eaeaea;
    }
    .modal-header-title { font-weight:600; font-size:1.08rem;}
    .modal-header-price { color:var(--lip-pink);font-size:1.3rem;font-weight:700;}
    #orderForm label { font-size: 1.01rem; font-weight: 600; display: block; margin-bottom: 7px; margin-top: 11px; }
    #orderForm input, #orderForm textarea {
      width: 100%; padding: 12px; font-size: 1.05rem; border: 1px solid #ccc; border-radius: 6px; box-sizing: border-box; font-family: 'Kanit', sans-serif;
    }
    .modal-submit-btn {
      width: 100%; background-color: var(--lip-pink); color: var(--white); border: none; padding: 15px; border-radius: 6px;
      font-size: 1.09rem; font-weight: 700; cursor: pointer; margin-top: 15px; font-family: 'Kanit', sans-serif;
      box-shadow: 0 1px 8px rgba(254,44,85,0.07);
      letter-spacing: 0.01em;
    }
    .modal-submit-btn:disabled { background-color: #d5d5d5; cursor: not-allowed; }
    #successPopup {
      display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
      background: rgba(255,255,255,0.95); color: #e94057; padding: 30px 42px; border-radius: 17px;
      z-index: 9999; text-align: center; font-size: 1.17rem; font-weight: 600; box-shadow: var(--shadow);
      animation: fadeIn 0.18s;
    }
    #successPopup i { font-size: 2.7rem; margin-bottom: 8px; color: #e94057; }
    .options-container { display: flex; gap: 9px; margin: 13px 0 9px 0; flex-wrap: wrap; }
    .option-btn {
      border: 2px solid #eee;
      border-radius: 8px;
      background: #fff;
      font-size: 1.05rem;
      font-weight: 700;
      color: #222;
      padding: 7px 14px;
      cursor: pointer;
      transition: border 0.14s, background 0.13s, color 0.13s;
      outline: none;
    }
    .option-btn.selected {
      border-color: var(--lip-pink);
      background: #ffdde7;
      color: var(--lip-pink);
      box-shadow: 0 1px 7px #ffd2bb44;
    }
    @media (max-width: 600px) {
      .content-padding { padding: 13px 8px; border-radius: 0;}
      .modal-content { padding: 17px 6px 15px 7px;}
      .sticky-footer .btn-add-line, .sticky-footer .buy-now-tiktok { font-size: 1.02rem;}
    }
  </style>
</head>
<body>
  <header>
    <h1 style="font-size:1.25rem;line-height:1.4em;color:#e94057;padding:14px 14px 2px 14px;text-align:center;">
      <span class="lip-label">ขายดี</span>
      <span class="lip-label green">ส่งฟรี</span>
      <span class="lip-label yellow">พร้อมส่ง</span>
      <span class="lip-label black">เก็บเงินปลายทาง</span><br>
      ลิปซอฟแมท <span style="font-weight:700;">M-BLITHE</span> สีสวย เม็ดสีแน่น ติดทนนาน
    </h1>
  </header>

  <div class="trust-banner">
    ✅ ของแท้ 100% | เก็บเงินปลายทาง | รีวิวลูกค้าหลายพัน | เบาสบาย ไม่แห้งปาก
  </div>

  <div class="product-gallery">
    <img src="/mnt/data/lip1.jpg" alt="ลิปซอฟแมท M-BLITHE สีสวย ติดทนนาน">
  </div>

  <section style="padding:10px 17px;">
    <p style="color:#999;font-size:0.96rem;margin:5px 0;">
      #ลิปซอฟแมท #ลิปแมท #mblithe #lipstick #softmatte #lipsoftmatte #ส่งฟรี #เก็บเงินปลายทาง
    </p>
  </section>

  <div class="content-padding">
    <div class="price-section">
      <span class="current-price">฿259</span>
      <span class="original-price">฿329</span>
    </div>
    <div class="product-title">✨ M-BLITHE ลิปซอฟแมท เม็ดสีแน่น ติดทนนาน ไม่แห้งปาก</div>
    <div style="text-align:center;margin:16px 0 10px 0;">
      <video autoplay muted loop playsinline controls style="max-width:340px;width:100%;border-radius:13px;box-shadow:0 2px 10px 0 rgba(0,0,0,0.10);">
        <source src="lipsoftmatte-demo.mp4" type="video/mp4">
        ไม่สามารถเล่นวิดีโอนี้ได้
      </video>
      <div style="font-size:0.93rem;color:#888;margin-top:2px;">
        รีวิวการใช้งานจริง
      </div>
    </div>
    <!-- Section เฉดสีลิป -->
    <div class="content-padding" style="margin-top:10px;">
      <h2 style="font-size:1.09rem;font-weight:600;margin-bottom:11px;">
        ✨ เลือกเฉดสีลิปซอฟแมท M-BLITHE ที่ใช่สำหรับคุณ!
      </h2>

      <!-- 991 สีชมพู-อมน้ำตาล -->
      <div style="text-align:center;margin-bottom:17px;">
        <img src="/mnt/data/ลิป991.jpg" alt="991 สีชมพู-อมน้ำตาล" style="width:230px;max-width:95%;border-radius:13px;box-shadow:0 2px 10px #0002;">
        <div style="font-size:1.14rem;font-weight:700;color:#e94057;margin-top:10px;">991 สีชมพู-อมน้ำตาล</div>
        <div style="color:#888;font-size:1.02rem;margin-top:6px;">
          ชมพู-อมน้ำตาล สวยสุภาพ ทาได้ทุกวัน<br><b>เหมาะกับ Everyday Look เข้าได้กับทุกสีผิว</b>
        </div>
      </div>
      <div style="text-align:center;margin:16px 0;">
        <span style="background:#e94057;color:#fff;padding:7px 18px;border-radius:8px;font-size:1.08rem;box-shadow:0 1px 6px #e9405744;">🌟 ทาแล้วปากดูสุขภาพดี!</span>
      </div>

      <!-- 994 สีชมพูกุหลาบ -->
      <div style="text-align:center;margin-bottom:17px;">
        <img src="/mnt/data/ลิป994.jpg" alt="994 สีชมพูกุหลาบ" style="width:230px;max-width:95%;border-radius:13px;box-shadow:0 2px 10px #0002;">
        <div style="font-size:1.14rem;font-weight:700;color:#e94057;margin-top:10px;">994 สีชมพูกุหลาบ</div>
        <div style="color:#888;font-size:1.02rem;margin-top:6px;">
          ชมพูกุหลาบหวานละมุน ทาได้ทุกโอกาส<br><b>ลุคสดใส สายหวานต้องมี!</b>
        </div>
      </div>
      <div style="text-align:center;margin:16px 0;">
        <span style="background:#fd91b1;color:#9c3366;padding:7px 18px;border-radius:8px;font-size:1.08rem;box-shadow:0 1px 6px #fd91b144;">💗 ลุคคุณหนู ดูละมุน!</span>
      </div>

      <!-- 996 สีน้ำตาลชมพู -->
      <div style="text-align:center;margin-bottom:17px;">
        <img src="/mnt/data/ลิป996.jpg" alt="996 สีน้ำตาลชมพู" style="width:230px;max-width:95%;border-radius:13px;box-shadow:0 2px 10px #0002;">
        <div style="font-size:1.14rem;font-weight:700;color:#e94057;margin-top:10px;">996 สีน้ำตาลชมพู</div>
        <div style="color:#888;font-size:1.02rem;margin-top:6px;">
          น้ำตาลชมพูสุดคลาสสิค ดูหรูหรา<br><b>สายแฟ สายสวยแพง ห้ามพลาด!</b>
        </div>
      </div>
      <div style="text-align:center;margin:16px 0;">
        <span style="background:#fdbe42;color:#884a00;padding:7px 18px;border-radius:8px;font-size:1.08rem;box-shadow:0 1px 6px #fdbe4244;">💛 สีนี้ทาแล้วหน้าไบรท์ขึ้น!</span>
      </div>
    </div>
    <!-- /Section เฉดสีลิป -->

    <div class="scarcity-box">
      🎉 <b>โปรพิเศษ! เหลือ 9 แท่ง</b> | ส่งฟรีวันนี้เท่านั้น
    </div>
    <div style="margin-top:14px;">
      <b>เลือกเฉดสี:</b>
      <div class="options-container" id="optionsContainer"></div>
    </div>
  </div>

  <div class="content-padding shop-info" style="border-radius:12px;">
    <div class="avatar">MB</div>
    <div>
      <div class="shop-name">M-BLITHE Official</div>
      <a href="https://lin.ee/wKelfsp" target="_blank" class="btn-add-line" id="addLineBtn">
        <i class="fa-brands fa-line"></i> สอบถาม-รับโปรผ่าน LINE
      </a>
    </div>
  </div>

  <div class="content-padding guarantee-box">
    🏅 รับประกันคุณภาพ สีสวย เม็ดสีแน่น เบาสบาย ไม่แห้งปาก
  </div>

  <div class="content-padding steps-box">
    <b>สั่งซื้อลิปซอฟแมทใน 2 ขั้นตอน</b><br>
    1. กรอกข้อมูลจัดส่ง<br>
    2. รอเจ้าหน้าที่ติดต่อยืนยัน
  </div>

  <div class="content-padding product-details">
    <h2 style="font-size:1.09rem;font-weight:600;margin-bottom:11px;">
      <i class="fa-solid fa-circle-info"></i> รายละเอียดสินค้า ลิปซอฟแมท M-BLITHE
    </h2>
    <div class="feature-item"><span class="icon">💄</span>เม็ดสีแน่น สีชัด ทาง่าย ไม่เป็นคราบ</div>
    <div class="feature-item"><span class="icon">💋</span>เนื้อนุ่ม เบาสบาย ไม่แห้งปาก ไม่ตกร่อง</div>
    <div class="feature-item"><span class="icon">🔒</span>ติดทนนาน ไม่หลุดง่าย ไม่เป็นขุย</div>
    <div style="color:#999;font-size:0.9rem;">* ผลลัพธ์แตกต่างกันแต่ละบุคคล</div>
  </div>

  <div class="content-padding reviews-section">
    <h3><i class="fa-solid fa-comments"></i> รีวิวจากลูกค้าจริง (Shopee)</h3>
    <div class="review">
      <div class="review-header">
        <span class="stars">⭐⭐⭐⭐⭐</span>
        <span class="author">อังศุมาลิน</span>
      </div>
      <p class="review-text">
        สีสวย ทาแล้วเบาสบายปากมากค่ะ ไม่ตกร่องเลย ชอบสุด ๆ
      </p>
      <img src="lipreview-1.jpg" alt="รีวิวลูกค้า"
        style="width:200px;max-width:100%;border-radius:12px;margin:14px 0 0 0;box-shadow:0 2px 12px #0001;">
      <div style="color:#aaa;font-size:0.92rem;margin-top:8px;">25 กรกฎาคม 2025</div>
    </div>
    <div class="review">
      <div class="review-header">
        <span class="stars">⭐⭐⭐⭐⭐</span>
        <span class="author">กาญจนา</span>
      </div>
      <p class="review-text">
        ติดทนนาน สีชัด ไม่เป็นขุยเลยค่ะ ซื้อซ้ำแน่นอน
      </p>
      <img src="lipreview-2.jpg" alt="รีวิวลูกค้า"
        style="width:200px;max-width:100%;border-radius:12px;margin:14px 0 0 0;box-shadow:0 2px 12px #0001;">
      <div style="color:#aaa;font-size:0.92rem;margin-top:8px;">20 กรกฎาคม 2025</div>
    </div>
  </div>

  <footer class="sticky-footer">
    <a href="https://lin.ee/wKelfsp" target="_blank" class="btn-add-line" id="addLineBtnFooter">
      <i class="fa-brands fa-line"></i> แอดไลน์รับโปร
    </a>
    <button class="buy-now-tiktok" id="buyNowBtn">ซื้อเลย</button>
  </footer>

  <div class="modal-overlay" id="buyNowModal">
    <div class="modal-content">
      <i class="fas fa-times close-btn" id="closeModalBtn"></i>
      <div class="modal-header">
        <img src="/mnt/data/ลิป991.jpg" alt="M-BLITHE Soft Matte Lip Thumbnail">
        <div>
          <div class="modal-header-title">M-BLITHE ลิปซอฟแมท</div>
          <div class="modal-header-price">฿259</div>
        </div>
      </div>
      <div style="margin-bottom:12px;"><b>เลือกเฉดสี:</b>
        <div class="options-container" id="modalOptionsContainer"></div>
      </div>
      <form id="orderForm" onsubmit="sendOrderToSheet(event);" autocomplete="off">
        <input type="hidden" name="product" id="productInput" required>
        <label for="name">ชื่อ-นามสกุล</label>
        <input type="text" id="name" name="name" required placeholder="กรอกชื่อ-นามสกุล">
        <label for="phone">เบอร์โทรศัพท์</label>
        <input type="text" id="phone" name="phone" required placeholder="ตัวอย่าง: 0812345678" pattern="^[0-9]{10}$" title="กรอกเบอร์โทรศัพท์ 10 หลัก">
        <label for="address">ที่อยู่จัดส่ง</label>
        <textarea id="address" name="address" rows="3" required placeholder="บ้านเลขที่, ถนน, ตำบล, อำเภอ, จังหวัด, รหัสไปรษณีย์"></textarea>
        <button type="submit" class="modal-submit-btn" id="submitBtn">ยืนยันสั่งซื้อ</button>
      </form>
    </div>
  </div>

  <div id="successPopup">
    <i class="fas fa-check-circle"></i>
    <p>สั่งซื้อสำเร็จ!</p>
    <span style="color:#222;font-weight:400;display:block;margin-top:7px;">เจ้าหน้าที่จะติดต่อกลับเพื่อยืนยันออเดอร์</span>
  </div>

  <script>
    const GOOGLE_SHEET_WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbxvkT44c1V26IyzQW_4FhR4iQ0gmrNvdhF5TnneqNZ-21JXFczyZBo-8EFzhA69WshT/exec';
    const products = [
      { id: '991', text: '991 - สีชมพู-อมน้ำตาล' },
      { id: '994', text: '994 - สีชมพูกุหลาบ' },
      { id: '996', text: '996 - สีน้ำตาลชมพู' }
    ];
    // === เฉดสีหน้า card
    const optionsContainer = document.getElementById('optionsContainer');
    products.forEach(product => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'option-btn';
      btn.textContent = product.text;
      btn.dataset.value = `${product.text} - 259 บาท`;
      btn.onclick = () => {
        document.querySelectorAll('#optionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // sync ไป modal
        document.querySelectorAll('#modalOptionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        document.querySelector(`#modalOptionsContainer .option-btn[data-value="${btn.dataset.value}"]`).classList.add('selected');
        document.getElementById('productInput').value = btn.dataset.value;
      };
      optionsContainer.appendChild(btn);
    });
    // === เฉดสีใน modal
    const modalOptionsContainer = document.getElementById('modalOptionsContainer');
    products.forEach(product => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'option-btn';
      btn.textContent = product.text;
      btn.dataset.value = `${product.text} - 259 บาท`;
      btn.onclick = () => {
        document.querySelectorAll('#modalOptionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        btn.classList.add('selected');
        // sync ไป product
        document.querySelectorAll('#optionsContainer .option-btn').forEach(b => b.classList.remove('selected'));
        document.querySelector(`#optionsContainer .option-btn[data-value="${btn.dataset.value}"]`).classList.add('selected');
        document.getElementById('productInput').value = btn.dataset.value;
      };
      modalOptionsContainer.appendChild(btn);
    });

    // Modal control
    const buyNowModal = document.getElementById('buyNowModal');
    const closeModalBtn = document.getElementById('closeModalBtn');
    const buyNowBtn = document.getElementById('buyNowBtn');
    function openModal() {
      buyNowModal.style.display = 'flex';
      if (window.fbq) fbq('track', 'InitiateCheckout');
      if (window.ttq) ttq.track('InitiateCheckout');
      if (window.gtag) gtag('event', 'begin_checkout', {
        value: 259.00,
        currency: 'THB'
      });
    }
    function closeModal() { buyNowModal.style.display = 'none'; }
    buyNowBtn.addEventListener('click', openModal);
    closeModalBtn.addEventListener('click', closeModal);
    buyNowModal.addEventListener('click', (event) => {
      if (event.target === buyNowModal) { closeModal(); }
    });

    // LINE Button Tracking
    function lineTrackingHandler() {
      if(window.fbq) fbq('track', 'Contact');
      if(window.ttq) ttq.track('Contact');
    }
    document.querySelectorAll('#addLineBtn, #addLineBtnFooter').forEach(el => {
      if(el) el.addEventListener('click', lineTrackingHandler);
    });

    // Form submit
    function sendOrderToSheet(event) {
      event.preventDefault();
      const orderForm = document.getElementById('orderForm');
      const submitButton = document.getElementById('submitBtn');
      const originalButtonText = submitButton.textContent;
      if (!document.getElementById('productInput').value) {
        alert('กรุณาเลือกเฉดสีก่อนค่ะ!');
        return;
      }
      submitButton.disabled = true;
      submitButton.textContent = 'กำลังส่งข้อมูล...';
      const formData = new FormData(orderForm);
      const phoneField = orderForm.querySelector('#phone');
      if (phoneField && phoneField.value && !phoneField.value.startsWith("'")) {
        formData.set('phone', "'" + phoneField.value);
      }
      formData.set("order_id", 'ORD-' + Date.now());
      fetch(GOOGLE_SHEET_WEB_APP_URL, {
        method: "POST", body: formData
      })
      .then(response => response.json())
      .then(data => {
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
        if (data.result === 'success') {
          closeModal();
          orderForm.reset();
          document.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
          document.getElementById('productInput').value = '';
          // Popup success
          const successPopup = document.getElementById('successPopup');
          successPopup.style.display = 'block';
          setTimeout(() => { successPopup.style.display = 'none'; }, 2400);

          // Trigger All Purchase Pixels
          if(window.fbq) fbq('track', 'Purchase', {value: 259.00, currency: 'THB'});
          if(window.ttq) ttq.track('CompletePayment', {
            contents: [{content_id:'MB-LIPSOFTMATTE',content_type:'product',quantity:1}],
            value: 259.00,
            currency: 'THB'
          });
          if(window.gtag) {
            gtag('event', 'conversion', {
              'send_to': 'AW-17035064059/53zPCNHE2OIaEPvl-bo_',
              'value': 259.00,
              'currency': 'THB'
            });
          }
        } else {
          alert('เกิดข้อผิดพลาด: ' + (data.message || 'ไม่ทราบสาเหตุ'));
        }
      })
      .catch(err => {
        submitButton.disabled = false;
        submitButton.textContent = originalButtonText;
        alert("เกิดข้อผิดพลาดในการส่งข้อมูล: " + err.message);
        console.error("Fetch Error:", err);
      });
    }
  </script>
</body>
</html>
